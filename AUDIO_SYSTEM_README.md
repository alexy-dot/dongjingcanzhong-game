# 音频系统使用说明

## 概述
本项目已经重新整理了音频控制系统，实现了在主页播放背景音乐的功能。

## 文件结构
```
script/manager/
├── audiocontroller.js    # 主页音频控制器
└── soundmanager.js       # 游戏音频管理器

assets/audios/
├── bgms/                 # 背景音乐文件
│   ├── unravel.mp3      # 主要背景音乐
│   └── ...
├── BGMs.json            # 背景音乐配置文件
└── Sounds.json          # 音效配置文件
```

## 主要功能

### 1. 主页音频控制 (index.html)
- **播放/暂停按钮**: 右上角圆形按钮，点击切换播放状态
- **控制面板**: 右侧垂直按钮组
  - 播放BGM: 开始播放背景音乐
  - 停止BGM: 停止并重置播放位置
  - 下一首: 切换到下一首音乐
  - 音量+/音量-: 调整音量
- **信息显示**: 左上角显示当前播放状态和音量

### 2. 音频特性
- 自动循环播放
- 音量记忆功能
- 浏览器兼容性处理
- 错误处理和用户提示

## 使用方法

### 基本播放
1. 打开 `index.html` 主页
2. 点击页面任意位置（浏览器要求用户交互）
3. 音乐将自动开始播放

### 控制操作
- **播放/暂停**: 点击右上角音乐按钮
- **音量调节**: 使用右侧音量按钮
- **切换音乐**: 点击"下一首"按钮

## 技术特点

### 1. 模块化设计
- `AudioController`: 专门用于主页音频控制
- `SoundManager`: 用于游戏内音频管理
- 两者可以独立使用

### 2. 浏览器兼容性
- 处理了现代浏览器的自动播放限制
- 提供了用户友好的错误提示
- 支持多种音频格式

### 3. 性能优化
- 音频预加载
- 事件监听器优化
- 内存管理

## 添加新音乐

### 方法1: 直接添加到播放列表
在 `audiocontroller.js` 中修改 `playlist` 数组：

```javascript
this.playlist = [
    {
        name: 'Unravel',
        src: 'assets/audios/bgms/unravel.mp3',
        artist: 'TK from 凛として時雨'
    },
    {
        name: '新音乐',
        src: 'assets/audios/bgms/新音乐.mp3',
        artist: '艺术家'
    }
];
```

### 方法2: 通过配置文件
在 `BGMs.json` 中添加新条目：

```json
{
    "bgm1": "./assets/audios/bgms/unravel.mp3",
    "bgm2": "./assets/audios/bgms/新音乐.mp3"
}
```

## 故障排除

### 常见问题

1. **音乐无法播放**
   - 检查浏览器是否允许自动播放
   - 点击页面任意位置后再试
   - 检查音频文件路径是否正确

2. **音量无法调节**
   - 确保音频控制器已正确初始化
   - 检查控制台是否有错误信息

3. **音频文件加载失败**
   - 验证文件路径
   - 检查文件格式是否支持
   - 确认文件权限

### 调试方法
- 打开浏览器开发者工具
- 查看控制台输出
- 检查网络面板中的音频文件加载状态

## 注意事项

1. **浏览器限制**: 现代浏览器要求用户交互后才能播放音频
2. **文件格式**: 推荐使用 MP3 格式，兼容性最好
3. **文件大小**: 大文件会影响页面加载速度
4. **移动设备**: 某些移动浏览器可能有额外的限制

## 更新日志

- **v1.0**: 初始版本，实现基本音频播放功能
- **v1.1**: 重构代码结构，分离音频控制器和游戏音频管理器
- **v1.2**: 添加音量控制、播放列表管理等功能
- **v1.3**: 优化用户界面，添加音乐信息显示
